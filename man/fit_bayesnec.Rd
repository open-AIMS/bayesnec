% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_bayesnec.R
\name{fit_bayesnec}
\alias{fit_bayesnec}
\title{fit_bayesnec}
\usage{
fit_bayesnec(
  data,
  x_var,
  y_var,
  trials_var = NA,
  x_type = NA,
  y_type = NA,
  x_range = NA,
  precision = 1000,
  over_disp = FALSE,
  model = NA,
  sig_val = 0.01,
  iter = 2000,
  warmup = floor(iter/5) * 4,
  ...
)
}
\arguments{
\item{data}{A \code{\link[base]{data.frame}} containing the data to use for the model.}

\item{x_var}{A \code{\link[base]{character}} indicating the column heading indicating the concentration (x) variable.}

\item{y_var}{A \code{\link[base]{character}} indicating the column heading indicating the response (y) variable.}

\item{trials_var}{The column heading indicating the column for the number of "trials" for binomial response data.
If not supplied, the model may run but will not be the model you intended!}

\item{x_type}{the statistical distribution to use for the x (concentration) data. This will be guess based on
the characteristic of the input data if not supplied. As some concentration-response data will use zero concentration,
and there is no distribution on the continuous scale from 0 to infinity (i.e. Tweedie) available in \code{\link[brms]{brm}},
a small offset is added (1/10^3 of the next lowest value) to zero values of concentration where these are gamma distributed.}

\item{y_type}{the statistical distribution to use for the y (response) data. This may currently be one of "binomial", "poisson",
"gaussian", or "gamma". Others can be added as required, please contact the package maintainer. If not supplied, the
appropriate distribution will be guessed based on the distribution of the input data.}

\item{x_range}{A range of x values over which to consider extracting ECX}

\item{precision}{tbw.}

\item{over_disp}{If an over-dispersed model should be used. Only changes the model fit for "poisson" and "binomial" \code{y_type}
data. For "poisson", a negative binomial model will be fit. For binomial a beta model will be fit.}

\item{model}{A \code{\link[base]{character}} vector indicating the model(s) to fit. See Details for more information.}

\item{sig_val}{Probability value to use as the lower quantile to test significance of the predictor posterior values
against the lowest observed concentration. Against the control, to estimate NEC as an interpolated NOEC value from smooth ECX curves.}

\item{iter}{the number of iterations to be passed to \code{\link[brms]{brm}}. Defaults to 2e4.}

\item{warmup}{A positive integer specifying number of warmup (a.k.a. burnin) iterations. This also specifies the number
of iterations used for stepsize adaptation, so warmup samples should not be used for inference. The number of warmup
should not be larger than "iter" and the default is "floor(iter / 5) * 4".}

\item{...}{Further arguments to \code{\link[brms]{brm}} via \code{\link{fit_bayesnec}}.}
}
\value{
The fitted brms model, including an estimate of the nec value and predicted posterior values.
A posterior sample of the NEC is also available under \code{nec_posterior}
}
\description{
Fits a concentration(dose)-response model using brms
}
\seealso{
\code{\link{bnec}}
}
