<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model details • bayesnec</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model details">
<meta property="og:description" content="bayesnec">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesnec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example1.html">Single model usage</a>
    </li>
    <li>
      <a href="../articles/example2.html">Multi model usage</a>
    </li>
    <li>
      <a href="../articles/example2b.html">Model details</a>
    </li>
    <li>
      <a href="../articles/example3.html">Priors</a>
    </li>
    <li>
      <a href="../articles/example4.html">Comparing posterior predictions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/open-aims/bayesnec/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example2b_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-aims/bayesnec/blob/master/vignettes/example2b.Rmd"><code>vignettes/example2b.Rmd</code></a></small>
      <div class="hidden name"><code>example2b.Rmd</code></div>

    </div>

    
    
<div id="models-in-bayesnec" class="section level1">
<h1 class="hasAnchor">
<a href="#models-in-bayesnec" class="anchor"></a>Models in <code>bayesnec</code>
</h1>
<p>There are a range of models available in <code>bayesnec</code> and the working <code>bnec</code> function supports individual model fitting, as well as multi-model fitting with Bayesian model averaging.</p>
<p>The argument <code>model</code> in a <code>bayesnecformula</code> is a character string indicating the name(s) of the desired model (see <code><a href="../reference/models.html">?models</a></code> for more details, and the list of models available). If a recognised model name is provided, a single model of the specified type is fit, and <code>bnec</code> returns a model object of class <code>bayesnecfit</code>. If a vector of two or more of the available models are supplied, <code>bnec</code> returns a model object of class <code>bayesmanecfit</code> containing Bayesian model averaged predictions for the supplied models, providing they were successfully fitted.</p>
<p>Model averaging is achieved through a weighted sample of each fitted models’ posterior predictions, with weights derived using the <code>loo_model_weights</code> function from <code>loo</code> <span class="citation">(<span class="citeproc-not-found" data-reference-id="vehtari2020"><strong>???</strong></span>; <span class="citeproc-not-found" data-reference-id="vehtari2017"><strong>???</strong></span>)</span>. Individual <code>brms</code> model fits can be extracted from the <code>mod_fits</code> element and can be examined individually.</p>
<p>The <code>model</code> may also be one of <code>"all"</code>, meaning all of the available models will be fit; <code>"ecx"</code> meaning only models excluding the <span class="math inline">\(\eta = \text{NEC}\)</span> step parameter will be fit; <code>"nec"</code> meaning only models with a specific <span class="math inline">\(\eta = \text{NEC}\)</span> step parameter will be fit; <code>"bot_free"</code> meaning only models without a <code>"bot"</code> parameter (without a bottom plateau) will be fit; <code>"zero_bounded"</code> are models that are bounded to be zero; or <code>"decline"</code> excludes all hormesis models, i.e., only allows a strict decline in response across the whole predictor range (see below <strong>Parameter definitions</strong>). There are a range of other pre-defined model groups available. The full list of currently implemented model groups can be seen using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://open-aims.github.io/bayesnec/">bayesnec</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/models.html">models</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; $nec</span>
<span class="co">#&gt;  [1] "nec3param"     "nec4param"     "nechorme"      "nechorme4"     "necsigm"       "neclin"        "neclinhorme"   "nechormepwr"  </span>
<span class="co">#&gt;  [9] "nechorme4pwr"  "nechormepwr01"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ecx</span>
<span class="co">#&gt;  [1] "ecx4param"   "ecxlin"      "ecxexp"      "ecxsigm"     "ecxwb1"      "ecxwb2"      "ecxwb1p3"    "ecxwb2p3"    "ecxll5"     </span>
<span class="co">#&gt; [10] "ecxll4"      "ecxll3"      "ecxhormebc4" "ecxhormebc5"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $all</span>
<span class="co">#&gt;  [1] "nec3param"     "nec4param"     "nechorme"      "nechorme4"     "necsigm"       "neclin"        "neclinhorme"   "nechormepwr"  </span>
<span class="co">#&gt;  [9] "nechorme4pwr"  "nechormepwr01" "ecxlin"        "ecxexp"        "ecxsigm"       "ecx4param"     "ecxwb1"        "ecxwb2"       </span>
<span class="co">#&gt; [17] "ecxwb1p3"      "ecxwb2p3"      "ecxll5"        "ecxll4"        "ecxll3"        "ecxhormebc4"   "ecxhormebc5"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bot_free</span>
<span class="co">#&gt;  [1] "nec3param"     "nechorme"      "necsigm"       "neclin"        "neclinhorme"   "nechormepwr"   "ecxlin"        "ecxexp"       </span>
<span class="co">#&gt;  [9] "ecxsigm"       "ecxwb1p3"      "ecxwb2p3"      "ecxll3"        "ecxhormebc4"   "nechormepwr01"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $zero_bounded</span>
<span class="co">#&gt;  [1] "nec3param"     "nechorme"      "necsigm"       "nechormepwr"   "nechormepwr01" "ecxexp"        "ecxsigm"       "ecxwb1p3"     </span>
<span class="co">#&gt;  [9] "ecxwb2p3"      "ecxll3"        "ecxhormebc4"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $decline</span>
<span class="co">#&gt;  [1] "nec3param" "nec4param" "necsigm"   "neclin"    "ecxlin"    "ecxexp"    "ecxsigm"   "ecx4param" "ecxwb1"    "ecxwb2"    "ecxwb1p3" </span>
<span class="co">#&gt; [12] "ecxwb2p3"  "ecxll5"    "ecxll4"    "ecxll3"</span></code></pre></div>
</div>
<div id="parameter-definitions" class="section level1">
<h1 class="hasAnchor">
<a href="#parameter-definitions" class="anchor"></a>Parameter definitions</h1>
<p>Where possible we have aimed for consistency in the interpretable meaning of the individual parameters across models. Across the currently implemented model set, models contain from two (basic linear or exponential decay, see <strong>ecxlin</strong> or <strong>ecxexp</strong>) to five possible parameters (<strong>nechorme4</strong>), including:</p>
<p><span class="math inline">\(\tau = \text{top}\)</span>, usually interpretable as either the y-intercept or the upper plateau representing the mean concentration of the response at zero concentration;</p>
<p><span class="math inline">\(\eta = \text{NEC}\)</span>, the No-Effect-Concentration value (the x concentration value where the breakpoint in the regression is estimated at, see <strong>Model types for <em>NEC</em> and <em>ECx</em> estimation</strong> and <span class="citation">(<span class="citeproc-not-found" data-reference-id="Fox2010"><strong>???</strong></span>)</span> for more details on parameter based <em>NEC</em> estimation);</p>
<p><span class="math inline">\(\beta = \text{beta}\)</span>, generally the exponential decay rate of response, either from 0 concentration or from the estimated <span class="math inline">\(\eta\)</span> value, with the exception of the <strong>neclinhorme</strong> model where it represents a linear decay from <span class="math inline">\(\eta\)</span> because slope (<span class="math inline">\(\alpha\)</span>) is required for the linear increase;</p>
<p><span class="math inline">\(\delta = \text{bottom}\)</span>, representing the lower plateau for the response at infinite concentration;</p>
<p><span class="math inline">\(\alpha = \text{slope}\)</span>, the linear decay rate in the models <strong>neclin</strong> and <strong>ecxlin</strong>, or the linear increase rate prior to <span class="math inline">\(\eta\)</span> for all hormesis models;</p>
<p><span class="math inline">\(\omega\)</span> = <span class="math inline">\(\text{EC\textsubscript{50}}\)</span> notionally the 50% effect concentration but may be influenced by scaling and should therefore not be strictly interpreted, and</p>
<p><span class="math inline">\(\epsilon = \text{d}\)</span>, the exponent in the <strong>ecxsigm</strong> and <strong>necisgm</strong> models.</p>
<p>In addition to the model parameters, all <strong>nec</strong>-containing models have a step function used to define the breakpoint in the regression, which can be defined as</p>
<p><span class="math display">\[
f(x_i, \eta) = \begin{cases} 
      0, &amp; x_i - \eta &lt; 0 \\
      1, &amp; x_i - \eta \geq 0 \\
   \end{cases}
\]</span></p>
</div>
<div id="model-types-for-nec-and-ecx-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#model-types-for-nec-and-ecx-estimation" class="anchor"></a>Model types for <em>NEC</em> and <em>ECx</em> estimation</h1>
<p>All models provide an estimate for the No-Effect-Concentration (<em>NEC</em>). For model types with <strong>nec</strong> as a prefix, the <em>NEC</em> is directly estimated as parameter <span class="math inline">\(\eta = \text{NEC}\)</span> in the model, as per <span class="citation">(<span class="citeproc-not-found" data-reference-id="Fox2010"><strong>???</strong></span>)</span>. Models with <strong>ecx</strong> as a prefix are continuous curve models, typically used for extracting <em>ECx</em> values from concentration-response data. In this instance the <em>NEC</em> reported is actually the No-Significant-Effect-Concentration (<em>NSEC</em>), defined as the concentration at which there is a user supplied (see <code>sig_val</code>) percentage certainty (based on the Bayesian posterior estimate) that the response falls below the estimated value of the upper asymptote (<span class="math inline">\(\tau = \text{top}\)</span>) of the response (i.e. the response value is significantly lower than that expected in the case of no exposure). The default value for <code>sig_val</code> is 0.01, which corresponds to an alpha value (Type-I error rate) of 0.01 for a one-sided test of significance. See <code><a href="../reference/nsec.html">?nsec</a></code> for more details. We currently recommend only using the <code>"nec"</code> model set for estimation of <em>NEC</em> values, as the <em>NSEC</em> concept has yet to be formally peer-reviewed.</p>
<p><em>ECx</em> estimates can be equally obtained from both <code>"nec"</code> and <code>"ecx"</code> models. <em>ECx</em> estimates will usually be lower (more conservative) for <code>"ecx"</code> models fitted to the same data as <code>"nec"</code> models (see the <a href="https://open-aims.github.io/bayesnec/articles/example4.html">Comparing posterior predictions</a>) vignette for an example. However, we recommend using <code>"all"</code> models where <em>ECx</em> estimation is required because <code>"nec"</code> models can fit some datasets better than <code>"ecx"</code> models and the model averaging approach will place the greatest weight for the outcome that best fits the supplied data. This approach will yield <em>ECx</em> estimates that are the most representative of the underlying relationship in the dataset.</p>
<p>There is ambiguity in the definition of <em>ECx</em> estimates from hormesis models—these allow an initial increase in the response <span class="citation">(see <span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span> and include models with the character string <code>horme</code> in their name—as well as those that have no natural lower bound on the scale of the response (models with the string <strong>lin</strong> in their name, in the case of Gaussian response data). For this reason the <code>ecx</code> function has arguments <code>hormesis_def</code> and <code>type</code>, both character vectors indicating the desired behaviour. For <code>hormesis_def = "max"</code>, <em>ECx</em> values are calculated as a decline from the maximum estimates (i.e., the peak at <span class="math inline">\(\eta = \text{NEC}\)</span>); and <code>hormesis_def = "control"</code> (the default) indicates that <em>ECx</em> values should be calculated relative to the control, which is assumed to be the lowest observed concentration. For <code>type = "relative"</code> <em>ECx</em> is calculated as the percentage decrease from the maximum predicted value of the response (<span class="math inline">\(\tau = \text{top}\)</span>) to the minimum predicted value of the response (i.e., <em>relative</em> to the observed data). For <code>type = "absolute"</code> (the default) <em>ECx</em> is calculated as the percentage decrease from the maximum value of the response (<span class="math inline">\(\tau = \text{top}\)</span>) to 0 (or <span class="math inline">\(\delta = \text{bottom}\)</span> for models with that parameter). For <code>type = "direct"</code>, a direct interpolation of the response on the predictor is obtained.</p>
</div>
<div id="model-suitability-for-response-types" class="section level1">
<h1 class="hasAnchor">
<a href="#model-suitability-for-response-types" class="anchor"></a>Model suitability for response types</h1>
<p>Models that have an exponential decay (most models with parameter <span class="math inline">\(\beta = \text{beta}\)</span>) with no <span class="math inline">\(\delta = \text{bottom}\)</span> parameter are 0-bounded and are not suitable for the Gaussian family, or any family modelled using a <code>"logit"</code> or <code>"log"</code> link because they cannot generate predictions of negative response values. Conversely, models with a linear decay (containing the string <strong>lin</strong> in their name) are not suitable for modelling families that are 0-bounded (Gamma, Poisson, Negative Binomial, Beta, Binomial, Beta-Binomial) using an <code>"identity"</code> link. These restrictions do not need to be controlled by the user, as a call to <code>bnec</code> with <code>models = "all"</code> in the formula will simply exclude inappropriate models, albeit with a message.</p>
<p>Strictly speaking, models with a linear hormesis increase are not suitable for modelling responses that are 0, 1-bounded (Binomial-, Beta- and Beta-Binomial-distributed), however they are currently allowed in <code>bayesnec</code>, with a reasonable fit achieved through a combination of the appropriate distribution being applied to the response, and <code>bayesnec</code>’s <code>make_inits</code> function which ensures initial values passed to <code>brms</code> yield response values within the range of the user-supplied response data.</p>
</div>
<div id="model-definitions" class="section level1">
<h1 class="hasAnchor">
<a href="#model-definitions" class="anchor"></a>Model definitions</h1>
<div id="ecx-models" class="section level2">
<h2 class="hasAnchor">
<a href="#ecx-models" class="anchor"></a><em>ECx</em> models</h2>
<p><img src="vignette-fig-exmp2b-theoretical_ecx_curves.png" title="" alt="" width="100%"></p>
<div id="ecxlin" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxlin" class="anchor"></a>ecxlin</h3>
<p>The <strong>ecxlin</strong> model is a basic linear decay model, given by the equation: <span class="math display">\[y_i = \tau - e^{\alpha} x_i\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top - exp(slope) * x 
#&gt; top ~ 1
#&gt; slope ~ 1</code></pre>
<p>Because the model contains linear predictors it is not suitable for 0, 1-bounded data (Binomial and Beta families with <code>"identity"</code> link). As the model includes a linear decline with concentration, it is also not suitable for 0, <code>Inf</code> bounded data (Gamma, Poisson, Negative Binomial with an <code>"identity"</code> link).</p>
</div>
<div id="ecxexp" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxexp" class="anchor"></a>ecxexp</h3>
<p>The <strong>ecxexp</strong> model is a basic exponential decay model, given by the equation: <span class="math display">\[y_i = \tau e^{-e^{\beta} x_i}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top * exp(-exp(beta) * x) 
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
<p>The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function.</p>
</div>
<div id="ecxsigm" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxsigm" class="anchor"></a>ecxsigm</h3>
<p>The <strong>ecxsigm</strong> model is a simple sigmoidal decay model, given by the equation: <span class="math display">\[y_i = \tau e^{-e^{\beta} x_i^{e^\epsilon}}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top * exp(-exp(beta) * x^exp(d)) 
#&gt; d ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
<p>The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function.</p>
</div>
<div id="ecx4param" class="section level3">
<h3 class="hasAnchor">
<a href="#ecx4param" class="anchor"></a>ecx4param</h3>
<p>The <strong>ecx4param</strong> model is a 4-parameter sigmoidal decay model, given by the equation: <span class="math display">\[y_i = \frac{\tau + (\delta - \tau)}{1 + e^{e^{\beta} (\omega - x_i)}}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top + (bot - top)/(1 + exp((ec50 - x) * exp(beta))) 
#&gt; bot ~ 1
#&gt; ec50 ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
</div>
<div id="ecxwb1" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxwb1" class="anchor"></a>ecxwb1</h3>
<p>The <strong>ecxwb1</strong> model is a 4-parameter sigmoidal decay model which is a slight reformulation of the Weibull1 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = \delta + (\tau - \delta) e^{-e^{e^{\beta} (x_i - \omega)}}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + (top - bot) * exp(-exp(exp(beta) * (x - ec50))) 
#&gt; bot ~ 1
#&gt; ec50 ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
</div>
<div id="ecxwb1p3" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxwb1p3" class="anchor"></a>ecxwb1p3</h3>
<p>The <strong>ecxwb1p3</strong> model is a 3-parameter sigmoidal decay model which is a slight reformulation of the Weibull1 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = {0} + (\tau - {0}) e^{-e^{e^{\beta} (x_i - \omega)}}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ 0 + (top - 0) * exp(-exp(exp(beta) * (x - ec50))) 
#&gt; ec50 ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
<p>The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function.</p>
</div>
<div id="ecxwb2" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxwb2" class="anchor"></a>ecxwb2</h3>
<p>The <strong>ecxwb2</strong> model is a 4-parameter sigmoidal decay model which is a slight reformulation of the Weibull2 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = \delta + (\tau - \delta) (1 - e^{-e^{e^{\beta} (x_i - \omega)}})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + (top - bot) * (1 - exp(-exp(-exp(beta) * (x - ec50)))) 
#&gt; bot ~ 1
#&gt; ec50 ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
<p>While very similar to the <strong>ecxwb1</strong> <span class="citation">(according to <span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, fitted <strong>ecxwb1</strong> and <strong>ecxwb2</strong> models can differ slightly.</p>
</div>
<div id="ecxwb2p3" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxwb2p3" class="anchor"></a>ecxwb2p3</h3>
<p>The <strong>ecxwb2p3</strong> model is a 3-parameter sigmoidal decay model, which is a slight reformulation of the Weibull2 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = {0} + (\tau -{0}) (1 - e^{-e^{e^{\beta} (x_i - \omega)}})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ 0 + (top - 0) * (1 - exp(-exp(-exp(beta) * (x - ec50)))) 
#&gt; ec50 ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1</code></pre>
<p>While very similar to the <strong>ecxwb1p3</strong> <span class="citation">(according to <span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, fitted <strong>ecxwb1p3</strong> and <strong>ecxwb2p3</strong> models can differ slightly. The model is 0-bounded, thus not suitable for Gaussian response data or the use of a logit or log link function.</p>
</div>
<div id="ecxll5" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxll5" class="anchor"></a>ecxll5</h3>
<p>The <strong>ecxll5</strong> model is a 5-parameter sigmoidal log-logistic decay model, which is a slight reformulation of the LL.5 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = \delta + (\tau - \delta)/ (1 + e^{-e^{\beta} (x_i - \omega^f)})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + (top - bot)/(1 + exp(exp(beta) * (x - ec50)))^exp(f) 
#&gt; bot ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; ec50 ~ 1
#&gt; f ~ 1</code></pre>
</div>
<div id="ecxll4" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxll4" class="anchor"></a>ecxll4</h3>
<p>The <strong>ecxll4</strong> model is a 4-parameter sigmoidal log-logistic decay model which is a slight reformulation of the LL.4 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = \delta + (\tau - \delta)/ (1 + e^{-e^{\beta} (x_i - \omega)})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + (top - bot)/(1 + exp(exp(beta) * (x - ec50))) 
#&gt; bot ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; ec50 ~ 1</code></pre>
</div>
<div id="ecxll3" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxll3" class="anchor"></a>ecxll3</h3>
<p>The <strong>ecxll3</strong> model is a 3-parameter sigmoidal log-logistic decay model, which is a slight reformulation of the LL.3 model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = 0 + (\tau - 0)/ (1 + e^{-e^{\beta} (x_i - \omega)})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ 0 + (top - 0)/(1 + exp(exp(beta) * (x - ec50))) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; ec50 ~ 1</code></pre>
<p>The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function.</p>
</div>
<div id="ecxhormebc5" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxhormebc5" class="anchor"></a>ecxhormebc5</h3>
<p>The <strong>ecxhormebc5</strong> model is a 5 parameter log-logistic model modified to accommodate a non-linear hormesis at low concentrations. It has been modified from to the “Brain-Cousens” (BC.5) model of <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ritz2016"><strong>???</strong></span>)</span>, given by the equation: <span class="math display">\[y_i = \delta + (\tau - \delta + e^{\alpha}*x)/ (1 + e^{-e^{\beta} (x_i - \omega)})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + (top - bot + exp(slope) * x)/(1 + exp(exp(beta) * (x - ec50))) 
#&gt; bot ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; ec50 ~ 1
#&gt; slope ~ 1</code></pre>
</div>
<div id="ecxhormebc4" class="section level3">
<h3 class="hasAnchor">
<a href="#ecxhormebc4" class="anchor"></a>ecxhormebc4</h3>
<p>The <strong>ecxhormebc4</strong> model is a 5-parameter log-logistic model similar to the <strong>exchormebc5</strong> model but with a lower bound of 0, given by the equation: <span class="math display">\[y_i = 0 + (\tau - 0 + e^{\alpha}*x)/ (1 + e^{-e^{\beta} (x_i - \omega)})\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ 0 + (top - 0 + exp(slope) * x)/(1 + exp(exp(beta) * (x - ec50))) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; ec50 ~ 1
#&gt; slope ~ 1</code></pre>
<p>The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function.</p>
</div>
</div>
<div id="nec-models" class="section level2">
<h2 class="hasAnchor">
<a href="#nec-models" class="anchor"></a><em>NEC</em> models</h2>
<p><img src="vignette-fig-exmp2b-theoretical_nec_curves.png" title="" alt="" width="100%"></p>
<div id="neclin" class="section level3">
<h3 class="hasAnchor">
<a href="#neclin" class="anchor"></a>neclin</h3>
<p>The <strong>neclin</strong> model is a basic linear decay model equivalent to <strong>ecxlin</strong> with the addition of the “nec” step function, given by the equation: <span class="math display">\[y_i = \tau - e^{\alpha} \left(x_i - \eta \right) f(x_i, \eta)\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top - exp(slope) * (x - nec) * step(x - nec) 
#&gt; top ~ 1
#&gt; slope ~ 1
#&gt; nec ~ 1</code></pre>
<p>Because the model contains linear predictors it is not suitable for 0, 1-bounded data (Binomial and Beta distributions with <code>"identity"</code> link). As the model includes a linear decline with concentration, it is also not suitable for 0, <code>Inf</code> bounded data (Gamma, Poisson, Negative Binomial with <code>"identity"</code> link).</p>
</div>
<div id="nec3param" class="section level3">
<h3 class="hasAnchor">
<a href="#nec3param" class="anchor"></a>nec3param</h3>
<p>The <strong>nec3param</strong> model is a basic exponential decay model equivalent to <strong>ecxexp</strong> with the addition of the “nec” step function, given by the equation: <span class="math display">\[y_i = \tau e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1</code></pre>
<p>For Binomial-distributed response data in the case of <code>"identity"</code> link this model is equivalent to that in <span class="citation">(<span class="citeproc-not-found" data-reference-id="Fox2010"><strong>???</strong></span>)</span>. The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function.</p>
</div>
<div id="nec4param" class="section level3">
<h3 class="hasAnchor">
<a href="#nec4param" class="anchor"></a>nec4param</h3>
<p>The <strong>nec4param</strong> model is a 3-parameter decay model with the addition of the “nec” step function, given by the equation: <span class="math display">\[y_i = \delta + (\tau - \delta) e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + (top - bot) * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; bot ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1</code></pre>
</div>
<div id="nechorme" class="section level3">
<h3 class="hasAnchor">
<a href="#nechorme" class="anchor"></a>nechorme</h3>
<p>The <strong>nechorme</strong> model is a basic exponential decay model with an “nec” step function equivalent to <strong>nec3param</strong>, with the addition of a linear increase prior to <span class="math inline">\(\eta\)</span>, given by the equation <span class="math display">\[y_i = (\tau + \alpha x_i) e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ (top + exp(slope) * x) * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; slope ~ 1</code></pre>
<p>The <strong>nechorme</strong> model is a <em>hormesis</em> model <span class="citation">(<span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span>, allowing an initial increase in the response variable at concentrations below <span class="math inline">\(\eta\)</span>. The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function. In this case the linear version (<strong>neclinhorme</strong>) should be used.</p>
</div>
<div id="nechormepwr" class="section level3">
<h3 class="hasAnchor">
<a href="#nechormepwr" class="anchor"></a>nechormepwr</h3>
<p>The <strong>nechormepwr</strong> model is a basic exponential decay model with an “nec” step function equivalent to <strong>nec3param</strong>, with the addition of a power increase prior to <span class="math inline">\(\eta\)</span>, given by the equation: <span class="math display">\[y_i = (\tau + x_i^{1/(1+e^{alpha})}) e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ (top + x^(1/(1 + exp(slope)))) * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; slope ~ 1</code></pre>
<p>The <strong>nechormepwr</strong> model is a <em>hormesis</em> model <span class="citation">(<span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span>, allowing an initial increase in the response variable at concentrations below <span class="math inline">\(\eta\)</span>. The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function. Because the model can generate predictions &gt; 1 it should not be used for Binomial and Beta distributions with <code>"identity"</code> link. In this case the <strong>nechromepwr01</strong> model should be used.</p>
</div>
<div id="neclinhorme" class="section level3">
<h3 class="hasAnchor">
<a href="#neclinhorme" class="anchor"></a>neclinhorme</h3>
<p>The <strong>neclinhorme</strong> model is a basic linear decay model with an “nec” step function equivalent to <strong>neclin</strong>, with the addition of a linear increase prior to <span class="math inline">\(\eta\)</span>, given by the equation: <span class="math display">\[y_i = (\tau + e^{\alpha} x_i) - e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)\]</span> and fitted in R via <code>brms</code> using the formula.</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ (top + exp(slope) * x) - exp(beta) * (x - nec) * step(x - nec) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; slope ~ 1</code></pre>
<p>The <strong>neclinhorme</strong> model is a <em>hormesis</em> model <span class="citation">(<span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span>, allowing an initial increase in the response variable at concentrations below <span class="math inline">\(\eta\)</span>. This model contains linear predictors and is not suitable for 0, 1-bounded data (Binomial and Beta distributions with <code>"identity"</code> link). As the model includes a linear decline with concentration, it is also not suitable for 0, <code>Inf</code> bounded data (Gamma, Poisson, Negative Binomial with <code>"identity"</code> link).</p>
</div>
<div id="nechorme4" class="section level3">
<h3 class="hasAnchor">
<a href="#nechorme4" class="anchor"></a>nechorme4</h3>
<p>The <strong>nechorme4</strong> model is 4 parameter decay model with an “nec” step function equivalent to <strong>nec4param</strong> with the addition of a linear increase prior to <span class="math inline">\(\eta\)</span>, given by the equation: <span class="math display">\[y_i = \delta + ((\tau + \alpha x_i) - \delta ) e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + ((top + exp(slope) * x) - bot) * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; bot ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; slope ~ 1</code></pre>
<p>The <strong>nechorme4</strong> model is a <em>hormesis</em> model <span class="citation">(<span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span>, allowing an initial increase in the response variable at concentrations below <span class="math inline">\(\eta\)</span>.</p>
</div>
<div id="nechorme4pwr" class="section level3">
<h3 class="hasAnchor">
<a href="#nechorme4pwr" class="anchor"></a>nechorme4pwr</h3>
<p>The <strong>nechorme4pwr</strong> model is 4 parameter decay model with an “nec” step function equivalent to <strong>nec4param</strong> with the addition of a power increase prior to <span class="math inline">\(\eta\)</span>, given by the equation: <span class="math display">\[y_i = \delta + ((\tau + x_i^{1/(1+e^{\alpha})}) e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ bot + ((top + x^(1/(1 + exp(slope)))) - bot) * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; bot ~ 1
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; slope ~ 1</code></pre>
<p>The <strong>nechorme4pwr</strong> model is a <em>hormesis</em> model <span class="citation">(<span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span>, allowing an initial power increase in the response variable at concentrations below <span class="math inline">\(\eta\)</span>. Because the model can generate predictions &gt; 1 it should not be used for Binomial and Beta distributions with <code>"identity"</code> link. In this case the <strong>nechromepwr01</strong> model should be used.</p>
</div>
<div id="nechormepwr01" class="section level3">
<h3 class="hasAnchor">
<a href="#nechormepwr01" class="anchor"></a>nechormepwr01</h3>
<p>The <strong>nechormepwr01</strong> model is a basic exponential decay model with an “nec” step function equivalent to <strong>nec3param</strong>, with the addition of a power increase prior to <span class="math inline">\(\eta\)</span>, given by the equation: <span class="math display">\[y_i = \left(\frac{1}{(1 + ((1/\tau)-1)  e^{-e^{\alpha}x_i}}\right) e^{-e^{\beta} \left(x_i - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ (1/(1 + ((1/top) - 1) * exp(-exp(slope) * x))) * exp(-exp(beta) * (x - nec) * step(x - nec)) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; slope ~ 1</code></pre>
<p>The <strong>nechormepwr01</strong> model is a <em>hormesis</em> model <span class="citation">(<span class="citeproc-not-found" data-reference-id="Mattson2008"><strong>???</strong></span>)</span>, allowing an initial increase in the response variable at concentrations below <span class="math inline">\(\eta\)</span>. The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function. In this case the linear version (<strong>neclinhorme</strong>) should be used.</p>
</div>
<div id="necsigm" class="section level3">
<h3 class="hasAnchor">
<a href="#necsigm" class="anchor"></a>necsigm</h3>
<p>The <strong>necsigm</strong> model is a basic exponential decay model equivalent to <strong>ecxlin</strong> with the addition of the “nec” step function, given by the equation: <span class="math display">\[y_i = \tau e^{-e^{\beta} \left(x_i^{e^\epsilon} - \eta \right) f(x_i, \eta)}\]</span> and fitted in R via <code>brms</code> using the formula</p>
<pre><code>#&gt; [[1]]
#&gt; y ~ top * exp(-exp(beta) * (step(x - nec) * (x - nec))^exp(d) * step(x - nec)) 
#&gt; top ~ 1
#&gt; beta ~ 1
#&gt; nec ~ 1
#&gt; d ~ 1</code></pre>
<p>The model is 0-bounded, thus not suitable for Gaussian response data or the use of a <code>"logit"</code> or <code>"log"</code> link function. In addition, there may be theoretical issues with combining a sigmoidal decay model with an “nec” step function because where there is an upper plateau in the data the location of <span class="math inline">\(\eta\)</span> may become ambiguous. Estimation of No-Effect-Concentrations using this model are not currently recommended without further testing.</p>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rebecca Fisher, Diego Barneche, Gerard Ricardo, David Fox.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
